<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />


<meta name="author" content="Created by Aaron Coyner" />


<title>R Tutorial: Confidence Intervals</title>

<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/flatly.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>


<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>

<link rel="stylesheet" href="styles.css" type="text/css" />

</head>

<body>

<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
  height: auto;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 60px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 65px;
  margin-top: -65px;
}

.section h2 {
  padding-top: 65px;
  margin-top: -65px;
}
.section h3 {
  padding-top: 65px;
  margin-top: -65px;
}
.section h4 {
  padding-top: 65px;
  margin-top: -65px;
}
.section h5 {
  padding-top: 65px;
  margin-top: -65px;
}
.section h6 {
  padding-top: 65px;
  margin-top: -65px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>


<div class="container-fluid main-container">

<!-- tabsets -->
<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});
</script>

<!-- code folding -->




<script>
$(document).ready(function ()  {

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_').toLowerCase();
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}


.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
  padding-left: 25px;
  text-indent: 0;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>

<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row-fluid">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Aaron Coyner, PhD Student</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="index.html">Home</a>
</li>
<li>
  <a href="projects.html">Projects</a>
</li>
<li>
  <a href="tutorials.html">Tutorials</a>
</li>
<li>
  <a href="publications.html">Publications</a>
</li>
<li>
  <a href="biosketch.html">BioSketch</a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div class="fluid-row" id="header">



<h1 class="title toc-ignore">R Tutorial: Confidence Intervals</h1>
<h4 class="author"><em>Created by Aaron Coyner</em></h4>

</div>


<style>
body {
    font-family: "Cabin", sans-serif;
}
p {
    font-family: "Cabin", sans-serif;
}
</style>
<p><a href="mailto:coyner@ohsu.edu"><i class="fa fa-envelope fa-fw"></i>  coyner@ohsu.edu</a><br></p>
<div id="overview" class="section level1">
<h1>Overview</h1>
<p>This tutorial provides an introduction to confidence intervals. Specifically, we will learn how to obtain confidence intervals for a population mean in R. Data sets and Rmarkdown files are available at: <a href="https://github.com/aaroncoyner/biostats-tutorials" class="uri">https://github.com/aaroncoyner/biostats-tutorials</a></p>
<div id="acknowledgements" class="section level2">
<h2>Acknowledgements</h2>
<p>This tutorial was adapted from <a href="https://ohsu-psu-sph.org/faculty-directory/name/amber-lin/">Amber Lin</a>'s tutorials for PHPM 524: Introduction to Biostatistics at Oregon Health &amp; Science University.</p>
<p>The template used for this tutorial is from <a href="https://github.com/apreshill/data-vis-jamboree-ggplot">Alison Presmanes-Hill</a></p>
</div>
</div>
<div id="setup" class="section level1">
<h1>Setup</h1>
<div id="install-packages" class="section level2">
<h2>Install Packages</h2>
<p>Do this once per machine.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">install.packages</span>(<span class="st">&#39;readr&#39;</span>)
<span class="kw">install.packages</span>(<span class="st">&#39;tidyverse&#39;</span>)
<span class="kw">install.packages</span>(<span class="st">&#39;skimr&#39;</span>)
<span class="kw">install.packages</span>(<span class="st">&#39;Publish&#39;</span>)</code></pre></div>
</div>
<div id="load-packages" class="section level2">
<h2>Load Packages</h2>
<p>Do this once per R session.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(readr)
<span class="kw">library</span>(tidyverse)
<span class="kw">library</span>(skimr)
<span class="kw">library</span>(Publish)</code></pre></div>
</div>
<div id="import-data" class="section level2">
<h2>Import Data</h2>
<ul>
<li>Copy <code>bone_density.csv</code> to an easily accessible location</li>
<li>Use <code>read_csv()</code> from the <code>readr</code> package to import the csv</li>
<li>The argument supplied to <code>read_csv()</code> is the url or path to the dataset</li>
<li>Finally, assign the data to an R object using <code>&lt;-</code> and call that object something simple like <code>bone</code></li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">bone &lt;-<span class="st"> </span><span class="kw">read_csv</span>(<span class="st">&#39;data/bone_density.csv&#39;</span>)</code></pre></div>
</div>
</div>
<div id="initial-data-analysis" class="section level1">
<h1>Initial Data Analysis</h1>
<div id="base-r" class="section level2">
<h2>Base R</h2>
<p>Use the <code>head()</code> function in your console to briefly check the structure of the data set.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">head</span>(bone)</code></pre></div>
<pre><code># A tibble: 6 x 32
      id   age zyg     ht1   wt1  tea1  cof1  alc1  cur1  men1  pyr1   ls1
   &lt;int&gt; &lt;int&gt; &lt;chr&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;int&gt; &lt;dbl&gt; &lt;dbl&gt;
1 1.48e6    36 Iden…   162    55     7    14     2     0     0   0.  0.730
2 1.52e6    44 Iden…   167    60     0    28    23    22     0   0.  0.770
3 1.25e6    73 Iden…   160    76    42    14    14     8     1  25.0 0.760
4 1.49e6    47 Iden…   149    61     0    42     2     3     1  12.0 0.710
5 1.03e6    61 Iden…   159    62    56     0     0     0     1   0.  0.810
6 1.63e6    53 Iden…   161    68    35    35     0     0     1  24.6 0.820
# ... with 20 more variables: fn1 &lt;dbl&gt;, fs1 &lt;dbl&gt;, ht2 &lt;int&gt;, wt2 &lt;int&gt;,
#   tea2 &lt;int&gt;, cof2 &lt;int&gt;, alc2 &lt;int&gt;, cur2 &lt;int&gt;, men2 &lt;int&gt;,
#   pyr2 &lt;dbl&gt;, ls2 &lt;dbl&gt;, fn2 &lt;dbl&gt;, fs2 &lt;dbl&gt;, fndiff12 &lt;dbl&gt;,
#   fndiff &lt;dbl&gt;, FSDIFF &lt;dbl&gt;, meanage &lt;dbl&gt;, stdage &lt;dbl&gt;, samp &lt;int&gt;,
#   serrage &lt;dbl&gt;</code></pre>
<p>As you can see, <code>head()</code> cannot display all of our variables! So we need to use some tools that are designed for larger data sets and that are a bit more descriptive...</p>
</div>
<div id="tidyverse-skimr" class="section level2">
<h2>tidyverse + skimr</h2>
<p>Glimpse essentially just provides us with a better view of our data than <code>head()</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">glimpse</span>(bone)</code></pre></div>
<pre><code>Observations: 41
Variables: 32
$ id       &lt;int&gt; 1479401, 1521701, 1248202, 1494101, 1034301, 1628601,...
$ age      &lt;int&gt; 36, 44, 73, 47, 61, 53, 49, 55, 72, 44, 52, 58, 72, 4...
$ zyg      &lt;chr&gt; &quot;Identical&quot;, &quot;Identical&quot;, &quot;Identical&quot;, &quot;Identical&quot;, &quot;...
$ ht1      &lt;int&gt; 162, 167, 160, 149, 159, 161, 164, 165, 154, 151, 157...
$ wt1      &lt;int&gt; 55, 60, 76, 61, 62, 68, 72, 68, 81, 48, 53, 61, 48, 6...
$ tea1     &lt;int&gt; 7, 0, 42, 0, 56, 35, 21, 56, 14, 12, 28, 0, 14, 14, 0...
$ cof1     &lt;int&gt; 14, 28, 14, 42, 0, 35, 14, 0, 7, 0, 28, 21, 56, 7, 21...
$ alc1     &lt;int&gt; 2, 23, 14, 2, 0, 0, 9, 2, 0, 0, 1, 0, 0, 2, 0, 10, 9,...
$ cur1     &lt;int&gt; 0, 22, 8, 3, 0, 0, 12, 3, 0, 0, 1, 0, 0, 2, 0, 15, 8,...
$ men1     &lt;int&gt; 0, 0, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1, 1, 2, 0, 0, 1, 0,...
$ pyr1     &lt;dbl&gt; 0.00, 0.00, 25.00, 12.00, 0.00, 24.65, 19.00, 0.00, 0...
$ ls1      &lt;dbl&gt; 0.73, 0.77, 0.76, 0.71, 0.81, 0.82, 0.67, 0.75, 0.71,...
$ fn1      &lt;dbl&gt; 0.64, 0.66, 0.56, 0.61, 0.64, 0.69, 0.74, 0.59, 0.55,...
$ fs1      &lt;dbl&gt; 1.09, 1.10, 1.05, 1.09, 1.12, 1.11, 1.14, 1.14, 0.93,...
$ ht2      &lt;int&gt; 163, 167, 161, 154, 162, 161, 164, 165, 160, 153, 160...
$ wt2      &lt;int&gt; 54, 43, 76, 94, 58, 60, 68, 71, 80, 52, 55, 73, 50, 6...
$ tea2     &lt;int&gt; 0, 0, 7, 0, 21, 0, 21, 21, 0, 91, 28, 0, 14, 0, 0, 7,...
$ cof2     &lt;int&gt; 35, 28, 7, 0, 35, 99, 12, 28, 0, 0, 0, 14, 42, 28, 28...
$ alc2     &lt;int&gt; 0, 13, 14, 0, 0, 0, 14, 0, 0, 0, 0, 0, 0, 14, 0, 14, ...
$ cur2     &lt;int&gt; 0, 20, 10, 1, 0, 1, 11, 1, 0, 0, 3, 2, 0, 13, 0, 10, ...
$ men2     &lt;int&gt; 0, 0, 1, 2, 1, 1, 1, 1, 1, 2, 1, 1, 1, 0, 0, 0, 1, 0,...
$ pyr2     &lt;dbl&gt; 25.50, 30.00, 40.00, 20.00, 29.75, 30.00, 36.30, 20.2...
$ ls2      &lt;dbl&gt; 0.70, 0.71, 0.66, 0.76, 0.85, 0.77, 0.74, 0.64, 0.63,...
$ fn2      &lt;dbl&gt; 0.61, 0.61, 0.49, 0.66, 0.69, 0.67, 0.74, 0.65, 0.56,...
$ fs2      &lt;dbl&gt; 1.20, 0.96, 1.04, 0.99, 1.03, 1.08, 1.10, 1.15, 1.01,...
$ fndiff12 &lt;dbl&gt; 0.03, 0.05, -0.07, -0.05, -0.05, -0.02, 0.00, -0.06, ...
$ fndiff   &lt;dbl&gt; 0.03, 0.05, -0.07, -0.05, -0.05, -0.02, 0.00, -0.06, ...
$ FSDIFF   &lt;dbl&gt; -0.11, 0.14, -0.01, 0.10, 0.09, -0.03, 0.04, -0.01, -...
$ meanage  &lt;dbl&gt; 51.38095, 51.38095, 51.38095, 51.38095, 51.38095, 51....
$ stdage   &lt;dbl&gt; 10.74000, 10.74000, 10.74000, 10.74000, 10.74000, 10....
$ samp     &lt;int&gt; 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 21, 2...
$ serrage  &lt;dbl&gt; 2.343660, 2.343660, 2.343660, 2.343660, 2.343660, 2.3...</code></pre>
<p>However, <code>skim()</code> computes summary statistics for us, as well. For instance, we get the mean, standard deviation, and quartiles for each variable. It even plots mini histograms for us!</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">skim</span>(bone)</code></pre></div>
<pre><code>Skim summary statistics
 n obs: 41 
 n variables: 32 

── Variable type:character ────────────────────────────────────────
 variable missing complete  n min max empty n_unique
      zyg       0       41 41   9   9     0        2

── Variable type:integer ──────────────────────────────────────────
 variable missing complete  n       mean        sd    p0     p25     p50
      age       0       41 41      48.85     11.77    27      42      47
     alc1       0       41 41       4.07      6.72     0       0       1
     alc2       0       41 41       5.29      8.14     0       0       0
     cof1       0       41 41      14.56     15.8      0       0       7
     cof2       0       41 41      23.15     21.09     0       7      21
     cur1       0       41 41       3.66      6.77     0       0       0
     cur2       0       41 41       5.07      7.55     0       0       1
      ht1       0       41 41     161.41      5.23   149     159     162
      ht2       0       41 41     161.59      4.67   150     159     162
       id       0       41 41 1476713.54 276086.32 1e+06 1273101 1528201
     men1       0       41 41       0.71      0.64     0       0       1
     men2       0       41 41       0.63      0.66     0       0       1
     samp       0       41 41      20.51      0.51    20      20      21
     tea1       0       41 41      19.32     18.11     0       1      14
     tea2       0       41 41      15.07     21.17     0       0       7
      wt1       0       41 41      65.39     14.89    47      57      61
      wt2       0       41 41      61.83     11.89    43      54      58
     p75    p100     hist
      53      76 ▂▃▇▇▃▃▁▃
       6      28 ▇▁▂▁▁▁▁▁
       9      35 ▇▁▁▂▁▁▁▁
      28      56 ▇▂▁▂▁▁▁▁
      35      99 ▇▅▇▂▁▁▁▁
       3      28 ▇▁▁▁▁▁▁▁
       8      30 ▇▂▂▁▁▁▁▁
     165     171 ▂▂▁▃▆▇▃▁
     165     170 ▁▃▁▅▅▇▂▂
 1628601 2609801 ▃▃▇▆▁▁▁▁
       1       2 ▆▁▁▇▁▁▁▂
       1       2 ▇▁▁▇▁▁▁▂
      21      21 ▇▁▁▁▁▁▁▇
      35      56 ▇▃▂▂▂▂▁▂
      21      91 ▇▅▁▁▁▁▁▁
      70     114 ▅▇▆▂▁▁▁▁
      68      94 ▁▇▇▂▂▁▁▁

── Variable type:numeric ──────────────────────────────────────────
 variable missing complete  n   mean     sd    p0   p25   p50   p75  p100
      fn1       0       41 41  0.66   0.1    0.42  0.6   0.66  0.72  0.9 
      fn2       0       41 41  0.66   0.12   0.38  0.61  0.66  0.74  0.88
   fndiff       0       41 41 -0.019  0.091 -0.25 -0.06 -0.03  0.05  0.16
 fndiff12       0       41 41 -0.019  0.091 -0.25 -0.06 -0.03  0.05  0.16
      fs1       0       41 41  1.1    0.13   0.7   1.05  1.11  1.15  1.42
      fs2       0       41 41  1.07   0.15   0.64  1.01  1.08  1.16  1.33
   FSDIFF       0       41 41 -0.015  0.12  -0.42 -0.1  -0.03  0.07  0.19
      ls1       0       41 41  0.79   0.13   0.5   0.71  0.8   0.87  1.04
      ls2       0       41 41  0.76   0.14   0.47  0.65  0.77  0.86  0.98
  meanage       0       41 41 48.85   2.62  46.2  46.2  51.38 51.38 51.38
     pyr1       0       41 41  4.36   9.33   0     0     0     0    33.75
     pyr2       0       41 41 27.51  14.82   5    14    25.5  39    64.5 
  serrage       0       41 41  2.56   0.23   2.34  2.34  2.34  2.79  2.79
   stdage       0       41 41 11.59   0.88  10.74 10.74 10.74 12.48 12.48
     hist
 ▂▂▅▇▆▃▃▂
 ▁▃▃▅▇▅▅▃
 ▁▂▂▃▇▃▃▂
 ▁▂▂▃▇▃▃▂
 ▁▁▁▆▇▃▁▁
 ▁▁▁▂▇▇▆▁
 ▁▁▁▂▇▅▇▃
 ▂▂▃▇▆▃▃▃
 ▃▁▇▃▇▇▆▅
 ▇▁▁▁▁▁▁▇
 ▇▁▁▁▁▁▁▁
 ▇▇▇▇▇▆▁▁
 ▇▁▁▁▁▁▁▇
 ▇▁▁▁▁▁▁▇</code></pre>
</div>
</div>
<div id="visualization" class="section level1">
<h1>Visualization</h1>
<p>Now that we've reviewed some summary statistics, the next step is to visualize our data. This will give us a better idea of the spread of the data for our variables of interest.</p>
<div id="boxplots" class="section level2">
<h2>Boxplots</h2>
<p>We can also look at a boxplot of the age distribution by twin type. To do so, we'll use <code>ggplot()</code>. There are a few things going on in this command, so we'll run through them one by one just to refresh your memory. First, we are calling <code>ggplot()</code> to tell R we'd like to create a plot. Next, we tell <code>ggplot()</code> which data set we'd like to use by supplying it as the first argument. Then we specify what <code>x</code> and <code>y</code> variables from the data set we'd like to use using the <code>aes()</code> (aesthetics) command. If we stop here, <code>ggplot</code> will know what data set we want to use and what variables we wish to model, but it won't know how we want them displayed and we'll just get an empty plot:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(bone, <span class="kw">aes</span>(<span class="dt">x =</span> zyg, <span class="dt">y =</span> age))</code></pre></div>
<p><img src="R_Tutorial_ConfidenceIntervals_files/figure-html/unnamed-chunk-4-1.png" width="672" /></p>
<p>So, we tell <code>ggplot()</code> that we'd like to use the specified variables from the specified data set to make a boxplot by adding <code>+ geom_boxplot()</code> after our call to <code>ggplot()</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(bone, <span class="kw">aes</span>(<span class="dt">x =</span> zyg, <span class="dt">y =</span> age)) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">geom_boxplot</span>()</code></pre></div>
<p><img src="R_Tutorial_ConfidenceIntervals_files/figure-html/unnamed-chunk-5-1.png" width="672" /></p>
<p>Great! But this plot is a bit...bland. Let's take advantage of <code>ggplot()</code> and make it more aesthetically pleasing!</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(bone, <span class="kw">aes</span>(<span class="dt">x =</span> zyg, <span class="dt">y =</span> age, <span class="dt">fill =</span> zyg)) <span class="op">+</span><span class="st"> </span>
<span class="st">  </span><span class="kw">geom_boxplot</span>() <span class="op">+</span>
<span class="st">  </span><span class="kw">ggtitle</span>(<span class="st">&quot;Boxplot of Age by Twin Type&quot;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">xlab</span>(<span class="st">&#39;Zygote Status&#39;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">ylab</span>(<span class="st">&#39;Age&#39;</span>)</code></pre></div>
<p><img src="R_Tutorial_ConfidenceIntervals_files/figure-html/unnamed-chunk-6-1.png" width="672" /></p>
</div>
<div id="confidence-intervals" class="section level2">
<h2>Confidence Intervals</h2>
<p>Again, we supply our basic arguments to <code>ggplot()</code>. Using the <code>stat_summary()</code> argument, we tell <code>ggplot()</code> that we'd like to compute both the mean and confidence interval for each group. In the first <code>stat_summary()</code> argument, we ask <code>ggplot()</code> to compute the 95% confidence interval using the <code>mean_cl_normal</code> function and represent it as error bars. We use the <code>fun.data</code> argument (rather than <code>fun.y</code>) because we wish to return a set of numbers (the high and low of each interval) rather than a single number (such as the mean).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="dt">data =</span> bone, <span class="kw">aes</span>(<span class="dt">x =</span> zyg, <span class="dt">y =</span> age)) <span class="op">+</span>
<span class="st">  </span><span class="kw">stat_summary</span>(<span class="dt">geom =</span> <span class="st">&quot;errorbar&quot;</span>,
               <span class="dt">fun.data =</span> mean_cl_normal)</code></pre></div>
<p><img src="R_Tutorial_ConfidenceIntervals_files/figure-html/unnamed-chunk-7-1.png" width="672" style="display: block; margin: auto;" /></p>
<p>Now we add a second <code>stat_summary()</code> argument and specify that we'd like to compute and represent the mean of each group as a red point on our chart.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="dt">data =</span> bone, <span class="kw">aes</span>(<span class="dt">x =</span> zyg, <span class="dt">y =</span> age)) <span class="op">+</span>
<span class="st">  </span><span class="kw">stat_summary</span>(<span class="dt">geom =</span> <span class="st">&quot;errorbar&quot;</span>,
               <span class="dt">fun.data =</span> mean_cl_normal) <span class="op">+</span>
<span class="st">  </span><span class="kw">stat_summary</span>(<span class="dt">geom =</span> <span class="st">&quot;point&quot;</span>,
               <span class="dt">fun.y =</span> mean,
               <span class="dt">color =</span> <span class="st">&quot;red&quot;</span>,
               <span class="dt">size =</span> <span class="dv">6</span>)</code></pre></div>
<p><img src="R_Tutorial_ConfidenceIntervals_files/figure-html/unnamed-chunk-8-1.png" width="672" style="display: block; margin: auto;" /></p>
<p><code>mean_cl_normal</code> computes a 95% confidence interval by default. If we want to calculate the 99% confidence interval, we make use of the <code>fun.args</code> parameter. This allows us to pass additional arguments to the function we've called, in the form of a list. Below, we compute the 99% confidence interval:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(<span class="dt">data =</span> bone, <span class="kw">aes</span>(<span class="dt">x =</span> zyg, <span class="dt">y =</span> age)) <span class="op">+</span>
<span class="st">  </span><span class="kw">stat_summary</span>(<span class="dt">geom =</span> <span class="st">&quot;errorbar&quot;</span>,
               <span class="dt">fun.data =</span> mean_cl_normal,
               <span class="dt">fun.args=</span><span class="kw">list</span>(<span class="dt">conf.int=</span><span class="fl">0.99</span>)) <span class="op">+</span>
<span class="st">  </span><span class="kw">stat_summary</span>(<span class="dt">geom =</span> <span class="st">&quot;point&quot;</span>,
               <span class="dt">fun.y =</span> mean,
               <span class="dt">color =</span> <span class="st">&quot;red&quot;</span>,
               <span class="dt">size =</span> <span class="dv">6</span>)</code></pre></div>
<p><img src="R_Tutorial_ConfidenceIntervals_files/figure-html/unnamed-chunk-9-1.png" width="672" style="display: block; margin: auto;" /></p>
</div>
</div>
<div id="confidence-intervals-1" class="section level1">
<h1>Confidence Intervals</h1>
<center>
<img src="img/conf.jpg" align="middle" height="450" width="750" margin="0 auto" />
</center>
<p>When we compute two-sided confidence intervals, we are computing the area between the two tails of the distribution. When we compute one-sided confidence intervals, we are computing the area from one tail up to (but not including) another tail. So, a one-sided 95% confidence interval includes more of the tail than a two-sided 95% confidence interval.</p>
<div id="two-sided" class="section level2">
<h2>Two-sided</h2>
<div id="for-a-variable" class="section level3">
<h3>For a Variable</h3>
<p>Let's compute 95% and 99% confidence intervals for the mean population age (<code>bone$age</code>). We'll use the <code>ci.mean()</code> command from <code>Publish</code>. By default, this command produces a 95% confidence interval.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ci.mean</span>(bone<span class="op">$</span>age)</code></pre></div>
<pre><code> mean  CI-95%       
 48.85 [45.14;52.57]</code></pre>
<p>Now, let's compute the 99% confidence interval. Remember that <span class="math inline">\(\alpha\)</span> is our significance level (i.e. the probability of incorrectly rejecting the null hypothesis). To obtain a 99% confidence interval, we simply set <span class="math inline">\(\alpha = 0.01\)</span>, since <span class="math inline">\(1 - confidence~level = \alpha\)</span>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ci.mean</span>(bone<span class="op">$</span>age, <span class="dt">alpha =</span> <span class="fl">0.01</span>)</code></pre></div>
<pre><code> mean  CI-99%       
 48.85 [43.88;53.82]</code></pre>
</div>
<div id="for-groups-within-a-variable" class="section level3">
<h3>For Groups within a Variable</h3>
<p>Let's compute a 95% confidence interval of the mean population age for fraternal and identical twins, denoted by the <code>zyg</code> variable. Remember, the <code>~</code> is R's way of saying &quot;by&quot;&quot; (i.e. &quot;compute this by this&quot;). So here, we compute <code>age</code> by <code>zyg</code>. Because we've only supplied R with the variables of interest, but haven't supplied the actual data set, we do so using the <code>data</code> argument.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ci.mean</span>(age <span class="op">~</span><span class="st"> </span>zyg, <span class="dt">data =</span> bone)</code></pre></div>
<pre><code> zyg       mean  CI-95%       
 fraternal 46.20 [40.36;52.04]
 Identical 51.38 [46.49;56.27]</code></pre>
<p>Theoretically, we could compute confidence intervals for age based on twin status and any other number of predictors. For example:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ci.mean</span>(age <span class="op">~</span><span class="st"> </span>zyg <span class="op">+</span><span class="st"> </span>men1, <span class="dt">data =</span> bone)</code></pre></div>
<pre><code> men1 zyg       mean  CI-95%         
 0    fraternal 39.56 [33.98;45.13]  
 0    Identical 42.00 [37.97;46.03]  
 1    fraternal 54.33 [44.18;64.49]  
 1    Identical 57.42 [51.02;63.81]  
 2    fraternal 39.50 [-30.38;109.38]
 2    Identical 48.00 [35.29;60.71]  </code></pre>
</div>
</div>
<div id="one-sided" class="section level2">
<h2>One-sided</h2>
<p>When we use z- or t-critical values for a one-sided 95% confidence limit, the critical values that we use are a bit different. In this instance, we are putting all 5% of the area into the lower or upper tail of the distribution depending on whether we want to calculate a one-sided lower bound or upper bound limit. For a 2-sided 95% confidence interval, we split up the area and put 2.5% in the lower and upper tails of the distribution. Refer to the image above to help visualize this idea.</p>
<p>Therefore, to calculate a one-sided 95% confidence bound (lower or upper), we use the z- or t-critical value for a 2-sided 90% confidence limit. Let’s say that we want to calculate a one-sided 95% upper confidence bound of age by twin type (fraternal or identical).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ci.mean</span>(age <span class="op">~</span><span class="st"> </span>zyg, <span class="dt">data =</span> bone, <span class="dt">alpha =</span> <span class="fl">0.10</span>)</code></pre></div>
<pre><code> zyg       mean  CI-90%       
 fraternal 46.20 [41.37;51.03]
 Identical 51.38 [47.34;55.42]</code></pre>
<p>Here, we are only interested in the upper confidence bounds. We can interpret this output as – “Average age of the identical twins is approximately 51 years and we are 95% confident that it is, at most, 55 years”. Similarly, we can interpret the mean age of fraternal twins as – “Average age of the fraternal twins is approximately 46 years and we are 95% confident that it is, at most, 51 years.”</p>
</div>
</div>

&nbsp;
<hr />
<p style="text-align: center;">&copy; 2018 <a href="https://github.com/aaroncoyner/">Aaron Coyner</a>. All rights reserved.</p>
<p style="text-align: center;"><a href="mailto:coyner@ohsu.edu"><i class="fa fa-envelope fa-lg"></i>&nbsp; coyner@ohsu.edu</a></p>

<!-- Add icon library -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">

<!-- Add font awesome icons -->
<p style="text-align: center;">
    <a href="https://twitter.com/aaron_coyner" class="fa fa-twitter fa-2x"></a>
    &nbsp; &nbsp;
    <a href="https://www.linkedin.com/in/aaroncoyner/" class="fa fa-linkedin fa-2x"></a>
    &nbsp; &nbsp;
    <a href="https://github.com/aaroncoyner/" class="fa fa-github fa-2x"></a>
</p>

&nbsp;


</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
