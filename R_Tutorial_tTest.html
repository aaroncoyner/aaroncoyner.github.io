<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />


<meta name="author" content="Created by Aaron Coyner" />


<title>R Tutorial: t-Tests</title>

<script src="site_libs/jquery-1.11.3/jquery.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/flatly.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link rel="shortcut icon" href="images/favicon.ico">


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>
<style type="text/css">
  pre:not([class]) {
    background-color: white;
  }
</style>


<style type="text/css">
h1 {
  font-size: 34px;
}
h1.title {
  font-size: 38px;
}
h2 {
  font-size: 30px;
}
h3 {
  font-size: 24px;
}
h4 {
  font-size: 18px;
}
h5 {
  font-size: 16px;
}
h6 {
  font-size: 12px;
}
.table th:not([align]) {
  text-align: left;
}
</style>

<link rel="stylesheet" href="styles.css" type="text/css" />

</head>

<body>

<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
code {
  color: inherit;
  background-color: rgba(0, 0, 0, 0.04);
}
img {
  max-width:100%;
  height: auto;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
</style>


<style type="text/css">
/* padding for bootstrap navbar */
body {
  padding-top: 60px;
  padding-bottom: 40px;
}
/* offset scroll position for anchor links (for fixed navbar)  */
.section h1 {
  padding-top: 65px;
  margin-top: -65px;
}

.section h2 {
  padding-top: 65px;
  margin-top: -65px;
}
.section h3 {
  padding-top: 65px;
  margin-top: -65px;
}
.section h4 {
  padding-top: 65px;
  margin-top: -65px;
}
.section h5 {
  padding-top: 65px;
  margin-top: -65px;
}
.section h6 {
  padding-top: 65px;
  margin-top: -65px;
}
</style>

<script>
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.parent().addClass('active');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');
});
</script>


<div class="container-fluid main-container">

<!-- tabsets -->
<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});
</script>

<!-- code folding -->




<script>
$(document).ready(function ()  {

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_').toLowerCase();
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}


.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
  padding-left: 25px;
  text-indent: 0;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>

<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row-fluid">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Aaron Coyner, PhD Student</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="index.html">Home</a>
</li>
<li>
  <a href="projects.html">Projects</a>
</li>
<li>
  <a href="tutorials.html">Tutorials</a>
</li>
<li>
  <a href="publications.html">Publications</a>
</li>
<li>
  <a href="biosketch.html">BioSketch</a>
</li>
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div class="fluid-row" id="header">



<h1 class="title toc-ignore">R Tutorial: t-Tests</h1>
<h4 class="author"><em>Created by Aaron Coyner</em></h4>

</div>


<style>
body {
    font-family: "Cabin", sans-serif;
}
p {
    font-family: "Cabin", sans-serif;
}
</style>
<p><a href="mailto:coyner@ohsu.edu"><i class="fa fa-envelope fa-fw"></i>Â  coyner@ohsu.edu</a><br></p>
<div id="overview" class="section level1">
<h1>Overview</h1>
<p>This tutorial provides an introduction to t-tests. A study by Goran et.al (1996) examined the accuracy of some widely used body-composition techniques for children using three different methods: dual-energy X-ray absorptiometry (DXA) technique, skin-fold thickness, and bioelectric resistance. Subjects were children between 4 and 10 years old. Data were collected on 98 subjects (49 males and 49 females). One purpose of the study is to determine whether there is a difference in fat mass measurements using DXA (considered the gold standard method) compared to the skin-fold thickness method. We also wish to determine if DXA levels are significantly different between males and females.</p>
<p>Data sets and Rmarkdown files are available at: <a href="https://github.com/aaroncoyner/biostats-tutorials" class="uri">https://github.com/aaroncoyner/biostats-tutorials</a></p>
<div id="acknowledgements" class="section level2">
<h2>Acknowledgements</h2>
<p>This tutorial was adapted from <a href="https://ohsu-psu-sph.org/faculty-directory/name/amber-lin/">Amber Lin</a>'s tutorials for PHPM 524: Introduction to Biostatistics at Oregon Health &amp; Science University.</p>
<p>The template used for this tutorial is from <a href="https://github.com/apreshill/data-vis-jamboree-ggplot">Alison Presmanes-Hill</a></p>
</div>
</div>
<div id="setup" class="section level1">
<h1>Setup</h1>
<div id="install-packages" class="section level2">
<h2>Install Packages</h2>
<p>Do this once per machine.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">install.packages</span>(<span class="st">&#39;readr&#39;</span>)
<span class="kw">install.packages</span>(<span class="st">&#39;skimr&#39;</span>)
<span class="kw">install.packages</span>(<span class="st">&#39;dplyr&#39;</span>)
<span class="kw">install.packages</span>(<span class="st">&#39;ggplot2&#39;</span>)
<span class="kw">install.packages</span>(<span class="st">&#39;rcompanion&#39;</span>)</code></pre></div>
</div>
<div id="load-packages" class="section level2">
<h2>Load Packages</h2>
<p>Do this once per R session.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(readr)
<span class="kw">library</span>(skimr)
<span class="kw">library</span>(dplyr)
<span class="kw">library</span>(ggplot2)
<span class="kw">library</span>(rcompanion)</code></pre></div>
</div>
<div id="import-data" class="section level2">
<h2>Import Data</h2>
<ul>
<li>Copy <code>body_comp.csv</code> to an easily accessible location</li>
<li>Use <code>read_csv()</code> from the <code>readr</code> package to import the csv</li>
<li>The argument supplied to <code>read_csv()</code> is the url or path to the data set</li>
<li>Finally, assign the data to an R object using <code>&lt;-</code> and call that object something simple like <code>body</code></li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">body &lt;-<span class="st"> </span><span class="kw">read_csv</span>(<span class="st">&#39;data/body_comp.csv&#39;</span>)</code></pre></div>
</div>
</div>
<div id="initial-data-analysis" class="section level1">
<h1>Initial Data Analysis</h1>
<p>Use the <code>head()</code> function in your console to briefly check the structure of the data set.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">head</span>(body)</code></pre></div>
<pre><code># A tibble: 6 x 4
    DXA    ST    BR   SEX
  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;int&gt;
1  3.65  4.55  4.26     1
2  3.92  2.82  6.09     0
3  7.53  3.89  5.12     0
4  6.24  5.49  8.04     0
5 10.6  10.5  14.2      0
6  9.58 11.2  12.4      0</code></pre>
<p><strong>Red Flag:</strong> Does the number <code>1</code> for <code>SEX</code> represent males or females? This is a good example of when value labels should be used or a data dictionary should be included!</p>
<p>Also notice that below each column header is a description of the data type. <code>&lt;dbl&gt;</code> simply means that the column can take on any numeric value from <span class="math inline">\(-\infty\)</span> to <span class="math inline">\(\infty\)</span> and <code>&lt;int&gt;</code> indicates the same but for integers only. However, does it make sense for <code>SEX</code> to be able to take on more than 2 numbers given this data set? We can &quot;tell&quot; R that these are labels, rather than continuous variables by changing the data type to a <code>factor</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">body<span class="op">$</span>SEX =<span class="st"> </span><span class="kw">as.factor</span>(body<span class="op">$</span>SEX)</code></pre></div>
<p><code>head()</code> provides us with a brief overview of the structure of our data set. Let's use <code>skim()</code> to compute some summary statistics, such as the mean, standard deviation, and quartiles of each variable. We notice that the means of <code>DXA</code> and <code>ST</code> really aren't all that different, but we must determine this statistically.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">skim</span>(body)</code></pre></div>
<pre><code>Skim summary statistics
 n obs: 98 
 n variables: 4 

ââ Variable type:factor âââââââââââââââââââââââââââââââââââââââââââ
 variable missing complete  n n_unique          top_counts ordered
      SEX       0       98 98        2 0: 49, 1: 49, NA: 0   FALSE

ââ Variable type:numeric ââââââââââââââââââââââââââââââââââââââââââ
 variable missing complete  n mean   sd   p0  p25  p50  p75  p100     hist
       BR       1       97 98 5.66 3.44 1.24 3.67 4.65 6.54 21.74 ââââââââ
      DXA       0       98 98 4.78 3    1.22 2.94 4.08 5.29 20.04 ââââââââ
       ST       0       98 98 4.99 3.09 2.09 3.13 4.01 5.46 19.56 ââââââââ</code></pre>
</div>
<div id="visualization" class="section level1">
<h1>Visualization</h1>
<div id="box-plots" class="section level2">
<h2>Box Plots</h2>
<p>We first need to stack our data so that we can create plots out of it. Then, since we are only interested in the <code>DXA</code> and <code>ST</code> variables, we filter by them. Finally, we pass the new data set to <code>ggplot()</code> and create a box plot. Upon comparison, it doesn't <em>appear</em> that the distributions are that different from one another.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">body <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">stack</span>() <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">filter</span>(ind <span class="op">==</span><span class="st"> &#39;DXA&#39;</span> <span class="op">|</span><span class="st"> </span>ind <span class="op">==</span><span class="st"> &#39;ST&#39;</span>) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> ind, <span class="dt">y =</span> values, <span class="dt">fill =</span> ind)) <span class="op">+</span>
<span class="st">    </span><span class="kw">geom_boxplot</span>() <span class="op">+</span>
<span class="st">    </span><span class="kw">ggtitle</span>(<span class="st">&#39;Box Plot of Body Fat Measurements&#39;</span>) <span class="op">+</span>
<span class="st">    </span><span class="kw">xlab</span>(<span class="st">&#39;Technique&#39;</span>) <span class="op">+</span>
<span class="st">    </span><span class="kw">ylab</span>(<span class="st">&#39;Body Fat Measurement&#39;</span>)</code></pre></div>
<p><img src="R_Tutorial_tTest_files/figure-html/box_plot-1.png" width="672" /></p>
<p>We can perform the same analysis for <code>DXA</code> measurements by <code>SEX</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(body, <span class="kw">aes</span>(<span class="dt">x =</span> SEX, <span class="dt">y =</span> DXA, <span class="dt">fill =</span> SEX)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_boxplot</span>() <span class="op">+</span>
<span class="st">  </span><span class="kw">ggtitle</span>(<span class="st">&#39;Box Plot of DXA vs SEX&#39;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">xlab</span>(<span class="st">&#39;SEX&#39;</span>) <span class="op">+</span>
<span class="st">  </span><span class="kw">ylab</span>(<span class="st">&#39;DXA&#39;</span>)</code></pre></div>
<p><img src="R_Tutorial_tTest_files/figure-html/unnamed-chunk-2-1.png" width="672" /></p>
</div>
<div id="density-plots" class="section level2">
<h2>Density Plots</h2>
<p>Even density plots of our data suggest that these two techniques produce similar measurements. HOWEVER, note that these distributions are <em>not</em> normal!</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">body <span class="op">%&gt;%</span>
<span class="st">  </span><span class="kw">stack</span>() <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">filter</span>(ind <span class="op">==</span><span class="st"> &#39;DXA&#39;</span> <span class="op">|</span><span class="st"> </span>ind <span class="op">==</span><span class="st"> &#39;ST&#39;</span>) <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x =</span> values, <span class="dt">fill =</span> ind)) <span class="op">+</span>
<span class="st">    </span><span class="kw">geom_density</span>(<span class="dt">alpha =</span> <span class="fl">0.5</span>)</code></pre></div>
<p><img src="R_Tutorial_tTest_files/figure-html/density_plot-1.png" width="672" /></p>
<p>Again, we can perform the same analysis for <code>DXA</code> measurements by <code>SEX</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(body, <span class="kw">aes</span>(<span class="dt">x =</span> DXA, <span class="dt">group =</span> SEX, <span class="dt">fill =</span> SEX)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_density</span>(<span class="dt">alpha =</span> <span class="fl">0.5</span>)</code></pre></div>
<p><img src="R_Tutorial_tTest_files/figure-html/unnamed-chunk-3-1.png" width="672" /></p>
</div>
</div>
<div id="t-tests" class="section level1">
<h1>t-Tests</h1>
<div id="single-sample" class="section level2">
<h2>Single-sample</h2>
<div id="hypothesis-there-is-a-difference-in-fat-mass-measurements-between-dxa-and-the-skin-fold-thickness-method." class="section level3">
<h3>HYPOTHESIS: There is a difference in fat mass measurements between DXA and the skin-fold thickness method.</h3>
<p>To conduct the analysis, we first need to generate a variable that describes the difference between <code>DXA</code> and <code>ST</code>. After, we'll can examine our tibble once more just to make sure everything worked as expected.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">body =<span class="st"> </span>body <span class="op">%&gt;%</span><span class="st"> </span>
<span class="st">  </span><span class="kw">mutate</span>(<span class="dt">DIFF =</span> DXA <span class="op">-</span><span class="st"> </span>ST)

<span class="kw">head</span>(body)</code></pre></div>
<pre><code># A tibble: 6 x 5
    DXA    ST    BR SEX     DIFF
  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;fct&gt;  &lt;dbl&gt;
1  3.65  4.55  4.26 1     -0.904
2  3.92  2.82  6.09 0      1.09 
3  7.53  3.89  5.12 0      3.64 
4  6.24  5.49  8.04 0      0.750
5 10.6  10.5  14.2  0      0.134
6  9.58 11.2  12.4  0     -1.60 </code></pre>
<p>Let's check whether the variable <code>DIFF</code> is normally distributed. We'll do this via histograms and density plots.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(body, <span class="kw">aes</span>(<span class="dt">x=</span>DIFF)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_histogram</span>(<span class="dt">bins=</span><span class="dv">9</span>, <span class="dt">color=</span><span class="st">&quot;darkblue&quot;</span>, <span class="dt">fill=</span><span class="st">&quot;lightblue&quot;</span>)</code></pre></div>
<p><img src="R_Tutorial_tTest_files/figure-html/histogram-1.png" width="672" /></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(body, <span class="kw">aes</span>(<span class="dt">x=</span>DIFF)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_density</span>(<span class="dt">fill=</span><span class="st">&quot;lightblue&quot;</span>)</code></pre></div>
<p><img src="R_Tutorial_tTest_files/figure-html/density_plot_DIFF-1.png" width="672" /></p>
<p><code>DIFF</code> sure does look normally distributed. This indicates that we can conduct a one sample t-test using it.</p>
<p>We'll now test whether <code>DIFF</code> is significantly different from 0, which is a round-about way of determining whether <code>DXA</code> is significantly different from <code>ST</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">t.test</span>(body<span class="op">$</span>DIFF, <span class="dt">mu=</span><span class="dv">0</span>)</code></pre></div>
<pre><code>
    One Sample t-test

data:  body$DIFF
t = -1.785, df = 97, p-value = 0.07739
alternative hypothesis: true mean is not equal to 0
95 percent confidence interval:
 -0.43787678  0.02320127
sample estimates:
 mean of x 
-0.2073378 </code></pre>
<p>From the output, we can see that the mean of <code>DIFF</code> for this sample is -0.2073378. The 95% confidence interval tells us that the mean of <code>DIFF</code> is likely to fall between -0.4378768 and 0.0232013. The p-value of 0.0773901 tells us that if the mean were 0, the probability of selecting a sample with a mean equal to this one would be approximately 7.74%.</p>
<p>Since the p-value is not less than the significance level of 0.05, we cannot reject the null hypothesis that the mean is equal to 0. This means that there is no evidence that the difference between <code>DXA</code> and <code>ST</code> is significant.</p>
</div>
</div>
<div id="paired" class="section level2">
<h2>Paired</h2>
<div id="hypothesis-there-is-a-difference-in-fat-mass-measurements-between-dxa-and-the-skin-fold-thickness-method.-1" class="section level3">
<h3>HYPOTHESIS: There is a difference in fat mass measurements between DXA and the skin-fold thickness method.</h3>
<p>Remember, when we are unsure of the arguments we should pass to a function in R, we can use the <code>?</code> to open a help page (e.g. <code>?t.test</code>). We see that to perform a paired t-test, we must set <code>paired</code> equal to <code>TRUE</code>. Our results suggest that there is no difference between the two techniques!</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">t.test</span>(body<span class="op">$</span>DXA, body<span class="op">$</span>ST, <span class="dt">paired=</span><span class="ot">TRUE</span>)</code></pre></div>
<pre><code>
    Paired t-test

data:  body$DXA and body$ST
t = -1.785, df = 97, p-value = 0.07739
alternative hypothesis: true difference in means is not equal to 0
95 percent confidence interval:
 -0.43787678  0.02320127
sample estimates:
mean of the differences 
             -0.2073378 </code></pre>
<p><strong>Note</strong>: this is equivalent to a one sample t-test comparing <code>DIFF</code> to a population mean of 0.</p>
</div>
<div id="hypothesis-there-is-a-difference-in-dxa-fat-mass-measurements-between-males-and-females." class="section level3">
<h3>HYPOTHESIS: There is a difference in DXA fat mass measurements between males and females.</h3>
<p>Before we conduct our second hypothesis test, do you remember the density plots we generated earlier? They suggested that our data did not come from a normal distribution. Let's look at some Q-Q plots to confirm this.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ggplot</span>(body, <span class="kw">aes</span>(<span class="dt">sample=</span>DXA, <span class="dt">group=</span>SEX, <span class="dt">color=</span>SEX)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_qq</span>() <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_qq_line</span>()</code></pre></div>
<p><img src="R_Tutorial_tTest_files/figure-html/unnamed-chunk-7-1.png" width="672" /></p>
<p>It's pretty easy to see that neither <code>SEX == 0</code> nor <code>SEX == 1</code> fall on a straight line, suggesting that <code>DXA</code> is <em>not</em> normally distributed. However, we can get around this.</p>
<p>We will transform <code>DXA</code> by conducting Tukey's Ladder of Powers to produce a more-normally distributed vector of values. As we can see from the histogram and Q-Q plot, <code>DXA</code> now appears to be normally distributed.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">transformTukey</span>(body<span class="op">$</span>DXA, <span class="dt">plotit=</span><span class="ot">TRUE</span>, <span class="dt">start=</span><span class="op">-</span><span class="dv">1</span>, <span class="dt">end=</span><span class="dv">2</span>, <span class="dt">int=</span><span class="fl">0.5</span>)</code></pre></div>
<p><img src="R_Tutorial_tTest_files/figure-html/unnamed-chunk-8-1.png" width="672" /></p>
<pre><code>
  lambda      W Shapiro.p.value
3      0 0.9828          0.2284

if (lambda &gt;  0){TRANS = x ^ lambda} 
if (lambda == 0){TRANS = log(x)} 
if (lambda &lt;  0){TRANS = -1 * x ^ lambda} </code></pre>
<p><img src="R_Tutorial_tTest_files/figure-html/unnamed-chunk-8-2.png" width="672" /><img src="R_Tutorial_tTest_files/figure-html/unnamed-chunk-8-3.png" width="672" /></p>
<pre><code> [1] 1.2942613 1.3654282 2.0189216 1.8312526 2.3598252 2.2592182 0.8929812
 [8] 1.2708555 0.2045722 0.8167797 0.9004459 1.4077378 1.4315067 1.0202543
[15] 1.4984617 1.4428873 1.0816696 1.0656413 1.7016706 1.2851472 1.6741577
[22] 1.1737507 1.7007218 1.5279458 1.0364177 1.4269323 1.3186577 1.5889086
[29] 1.3644577 2.4948240 2.7377320 2.9978999 2.2544447 1.0022482 1.3604893
[36] 1.5947506 1.2740491 1.9137263 1.1836578 0.4354769 0.7618800 1.4325575
[43] 0.6862736 1.2213018 0.8391073 0.6451117 1.3282414 0.8545004 1.5432340
[50] 1.5530792 1.4527607 0.9731246 0.9948431 1.5292685 1.1280416 1.6200415
[57] 1.9236791 2.4029190 1.4958212 0.9101117 2.0109352 2.1403014 1.8952482
[64] 1.4708193 1.2895632 1.5230736 0.8306457 1.2865845 0.8347335 1.4684502
[71] 1.4042816 0.5837786 1.4213719 1.7073991 1.1670183 1.6426212 1.3766227
[78] 1.3001372 1.4700149 1.0789876 1.6170092 2.0680646 0.5778486 1.2419331
[85] 2.4354012 0.2001615 1.0775589 1.5460933 2.0946626 2.3040041 0.9399291
[92] 1.3262524 1.4364883 1.9071693 1.2547895 0.8101744 1.9725660 1.8623732</code></pre>
<p>So, what have we done here? First, we have tested various values of <span class="math inline">\(\lambda\)</span> ranging from -1 to 2 at intervals of 0.5. When <span class="math inline">\(\lambda &lt; 0\)</span>, we transform our data via <span class="math inline">\(-1 * x ^ \lambda\)</span>, when <span class="math inline">\(\lambda = 0\)</span>, we transform our data via <span class="math inline">\(log(x)\)</span>, and when <span class="math inline">\(\lambda &gt; 0\)</span>, we transform our data via <span class="math inline">\(x ^ \lambda\)</span>. This configuration tests the following transforms: <span class="math inline">\(-1/x, -1/\sqrt(x), log(x), \sqrt(x), x,~and~x^2\)</span>.</p>
<p>The output of this function tells us that method 3, where <span class="math inline">\(\lambda = 0\)</span>, maximizes the Shapiro-Wilks W statistic. In English, this means that a log-transform of this vector will produce a more-normal distribution.</p>
<p>We can log transform <code>DXA</code> into a log base 2, log base 3, or log base 10 variable. For ease of interpretation it is not recommended that we use natural log. Here we will transform it into a log base 2 variable.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">body<span class="op">$</span>log2_DXA &lt;-<span class="st"> </span><span class="kw">log2</span>(body<span class="op">$</span>DXA)</code></pre></div>
<p>Now that we've morphed our data to meet the assumptions of our test, we can now conduct a 2-sample t-test. But before we do that, we must assess whether or not the variances of each group are equal. If we look at the standard deviations of the log-transformed <code>DXA</code> for the two genders, they are pretty equal.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">sd</span>(body<span class="op">$</span>log2_DXA[body<span class="op">$</span>SEX <span class="op">==</span><span class="st"> </span><span class="dv">0</span>])</code></pre></div>
<pre><code>[1] 0.7151531</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">sd</span>(body<span class="op">$</span>log2_DXA[body<span class="op">$</span>SEX <span class="op">==</span><span class="st"> </span><span class="dv">1</span>])</code></pre></div>
<pre><code>[1] 0.7322937</code></pre>
<p>Therefore, we can use a t-test where we treat the two variances as being equal.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">t.test</span>(log2_DXA <span class="op">~</span><span class="st"> </span>SEX, <span class="dt">data=</span>body, <span class="dt">var.equal=</span><span class="ot">TRUE</span>)</code></pre></div>
<pre><code>
    Two Sample t-test

data:  log2_DXA by SEX
t = 3.1605, df = 96, p-value = 0.002108
alternative hypothesis: true difference in means is not equal to 0
95 percent confidence interval:
 0.1718829 0.7523894
sample estimates:
mean in group 0 mean in group 1 
       2.278543        1.816407 </code></pre>
<p>It appears that the log-transformed mean <code>DXA</code> levels are significantly different for males versus females (<span class="math inline">\(p=0.002108\)</span>).</p>
</div>
</div>
<div id="unequal-variances" class="section level2">
<h2>Unequal Variances</h2>
<div id="hypothesis-there-is-a-difference-in-dxa-fat-mass-measurements-between-males-and-females.-1" class="section level3">
<h3>HYPOTHESIS: There is a difference in DXA fat mass measurements between males and females.</h3>
<p>So, a t-test with equal variance is fine, but let us run through a t-test with unequal variances to illustrate how to use software to conduct that test. Râs default t-test uses the unequal variance assumption. So, if weâd like to conduct a t-test with unequal variances, we actually don't have to supply a value for the <code>var.equal</code> argument at all.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">t.test</span>(log2_DXA <span class="op">~</span><span class="st"> </span>SEX, <span class="dt">data =</span> body)</code></pre></div>
<pre><code>
    Welch Two Sample t-test

data:  log2_DXA by SEX
t = 3.1605, df = 95.946, p-value = 0.002108
alternative hypothesis: true difference in means is not equal to 0
95 percent confidence interval:
 0.1718808 0.7523914
sample estimates:
mean in group 0 mean in group 1 
       2.278543        1.816407 </code></pre>
<p>The conclusion doesnât change, but notice that the degrees of freedom for a t-test with unequal variances are calculated using the Welch (or Satterthwaite) formula.</p>
</div>
</div>
</div>

&nbsp;
<hr />
<p style="text-align: center;">&copy; 2018 <a href="https://github.com/aaroncoyner/">Aaron Coyner</a>. All rights reserved.</p>
<p style="text-align: center;"><a href="mailto:coyner@ohsu.edu"><i class="fa fa-envelope fa-lg"></i>&nbsp; coyner@ohsu.edu</a></p>

<!-- Add icon library -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">

<!-- Add font awesome icons -->
<p style="text-align: center;">
    <a href="https://twitter.com/aaron_coyner" class="fa fa-twitter fa-2x"></a>
    &nbsp; &nbsp;
    <a href="https://www.linkedin.com/in/aaroncoyner/" class="fa fa-linkedin fa-2x"></a>
    &nbsp; &nbsp;
    <a href="https://github.com/aaroncoyner/" class="fa fa-github fa-2x"></a>
</p>

&nbsp;


</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.header').parent('thead').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
